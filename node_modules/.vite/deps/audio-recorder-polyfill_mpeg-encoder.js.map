{
  "version": 3,
  "sources": ["../../audio-recorder-polyfill/mpeg-encoder/index.js"],
  "sourcesContent": ["export default () => {\n  importScripts(\n    'https://cdnjs.cloudflare.com/ajax/libs/lamejs/1.2.0/lame.min.js'\n  )\n\n  let CHANNELS = 1\n  let KBPS = 128\n  let DEFAULT_SAMPLE_RATE = 44100\n\n  let encoder\n  let recorded = new Int8Array()\n\n  function concat (a, b) {\n    if (b.length === 0) {\n      return a\n    }\n    let c = new Int8Array(a.length + b.length)\n    c.set(a)\n    c.set(b, a.length)\n    return c\n  }\n\n  function init (sampleRate) {\n    encoder = new lamejs.Mp3Encoder(\n      CHANNELS,\n      sampleRate || DEFAULT_SAMPLE_RATE,\n      KBPS\n    )\n  }\n\n  function encode (buffer) {\n    for (let i = 0; i < buffer.length; i++) {\n      buffer[i] = buffer[i] * 32767.5\n    }\n\n    let buf = encoder.encodeBuffer(buffer)\n    recorded = concat(recorded, buf)\n  }\n\n  function dump () {\n    let buf = encoder.flush()\n    recorded = concat(recorded, buf)\n    let buffer = recorded.buffer\n    recorded = new Int8Array()\n    postMessage(buffer, [buffer])\n  }\n\n  onmessage = e => {\n    if (e.data[0] === 'init') {\n      init(e.data[1])\n    } else if (e.data[0] === 'encode') {\n      encode(e.data[1])\n    } else {\n      dump(e.data[1])\n    }\n  }\n}\n"],
  "mappings": ";;;AAAA,IAAO,uBAAQ,MAAM;AACnB;AAAA,IACE;AAAA,EACF;AAEA,MAAI,WAAW;AACf,MAAI,OAAO;AACX,MAAI,sBAAsB;AAE1B,MAAI;AACJ,MAAI,WAAW,IAAI,UAAU;AAE7B,WAAS,OAAQ,GAAG,GAAG;AACrB,QAAI,EAAE,WAAW,GAAG;AAClB,aAAO;AAAA,IACT;AACA,QAAI,IAAI,IAAI,UAAU,EAAE,SAAS,EAAE,MAAM;AACzC,MAAE,IAAI,CAAC;AACP,MAAE,IAAI,GAAG,EAAE,MAAM;AACjB,WAAO;AAAA,EACT;AAEA,WAAS,KAAM,YAAY;AACzB,cAAU,IAAI,OAAO;AAAA,MACnB;AAAA,MACA,cAAc;AAAA,MACd;AAAA,IACF;AAAA,EACF;AAEA,WAAS,OAAQ,QAAQ;AACvB,aAAS,IAAI,GAAG,IAAI,OAAO,QAAQ,KAAK;AACtC,aAAO,CAAC,IAAI,OAAO,CAAC,IAAI;AAAA,IAC1B;AAEA,QAAI,MAAM,QAAQ,aAAa,MAAM;AACrC,eAAW,OAAO,UAAU,GAAG;AAAA,EACjC;AAEA,WAAS,OAAQ;AACf,QAAI,MAAM,QAAQ,MAAM;AACxB,eAAW,OAAO,UAAU,GAAG;AAC/B,QAAI,SAAS,SAAS;AACtB,eAAW,IAAI,UAAU;AACzB,gBAAY,QAAQ,CAAC,MAAM,CAAC;AAAA,EAC9B;AAEA,cAAY,OAAK;AACf,QAAI,EAAE,KAAK,CAAC,MAAM,QAAQ;AACxB,WAAK,EAAE,KAAK,CAAC,CAAC;AAAA,IAChB,WAAW,EAAE,KAAK,CAAC,MAAM,UAAU;AACjC,aAAO,EAAE,KAAK,CAAC,CAAC;AAAA,IAClB,OAAO;AACL,WAAK,EAAE,KAAK,CAAC,CAAC;AAAA,IAChB;AAAA,EACF;AACF;",
  "names": []
}
